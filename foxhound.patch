diff --git a/js/src/jsapi.cpp b/js/src/jsapi.cpp
index 4a57cbdfcc..cd4d24bfc4 100644
--- a/js/src/jsapi.cpp
+++ b/js/src/jsapi.cpp
@@ -4803,27 +4803,34 @@ JS_ReportTaintSink(JSContext* cx, JS::HandleString str, const char* sink, JS::Ha
     const char* argnames[3] = {"str", "sink", "stack"};
     const char* funbody =
       "if (typeof window !== 'undefined' && typeof document !== 'undefined') {\n"
-      "    var t = window;\n"
-      "    if (location.protocol == 'javascript:' || location.protocol == 'data:' || location.protocol == 'about:') {\n"
-      "        t = parent.window;\n"
-      "    }\n"
-      "    var pl;\n"
-      "    try {\n"
-      "        pl = parent.location.href;\n"
-      "    } catch (e) {\n"
-      "        pl = 'different origin';\n"
-      "    }\n"
-      "    var e = document.createEvent('CustomEvent');\n"
-      "    e.initCustomEvent('__taintreport', true, false, {\n"
-      "        subframe: t !== window,\n"
-      "        loc: location.href,\n"
-      "        parentloc: pl,\n"
-      "        referrer: document.referrer,\n"
-      "        str: str,\n"
-      "        sink: sink,\n"
-      "        stack: stack\n"
-      "    });\n"
-      "    t.dispatchEvent(e);\n"
+      "  var t = window;\n"
+      "  if (\n"
+      "    location.protocol == 'javascript:' ||\n"
+      "    location.protocol == 'data:' ||\n"
+      "    location.protocol == 'about:'\n"
+      "  ) {\n"
+      "    t = parent.window;\n"
+      "  }\n"
+      "  var parentloc;\n"
+      "  try {\n"
+      "    parentloc = parent.location.href;\n"
+      "  } catch (e) {\n"
+      "    parentloc = 'different origin';\n"
+      "  }\n"
+      "  var taintReport = {\n"
+      "    subframe: t !== window,\n"
+      "    loc: location.href,\n"
+      "    parentloc: parentloc,\n"
+      "    referrer: document.referrer,\n"
+      "    str: str,\n"
+      "    sink: sink,\n"
+      "    stack: stack,\n"
+      "    taint: str.taint,\n"
+      "  };\n"
+      "  window['$__taintReports'] = [\n"
+      "    ...(window['$__taintReports'] || []),\n"
+      "    taintReport,\n"
+      "  ];\n"
       "}";
     CompileOptions options(cx);
     options.setFile("taint_reporting.js");
